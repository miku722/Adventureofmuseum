# æ€è€ƒæ­¥éª¤å®Œæ•´æµç¨‹è¯¦è§£

## ğŸ” æ¦‚è¿°
"æ€è€ƒå®Œæˆ"é‡Œçš„æ¶ˆæ¯æ¥è‡ªäº AI çš„è¿”å›ï¼Œç»è¿‡è§£æã€åˆ†å‰²ã€ä¿å­˜ã€æ¸²æŸ“ç­‰å¤šä¸ªæ­¥éª¤ã€‚

---

## ğŸ“‹ å®Œæ•´æµç¨‹

### 1ï¸âƒ£ **ç³»ç»Ÿæç¤ºè¯è¦æ±‚** (NPCChat.tsx ç¬¬ 289-350 è¡Œ)

```typescript
const enhancedSystemPrompt = `${systemPrompt}

=== é‡è¦ï¼šæ€è€ƒè¿‡ç¨‹è¾“å‡ºæ ¼å¼ ===
**ä½ å¿…é¡»ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹æ ¼å¼è¾“å‡ºï¼Œä¸å¯çœç•¥ä»»ä½•éƒ¨åˆ†ï¼š**

[æ€è€ƒå¼€å§‹]
ç”¨è‡ªç„¶è¯­è¨€æ€è€ƒä»¥ä¸‹å†…å®¹ï¼ˆå³ä½¿æ²¡æœ‰å¤æ‚æƒ…å†µï¼Œä¹Ÿè¦ç®€å•æ€è€ƒä¸€ä¸‹ï¼‰ï¼š
1. ç©å®¶èƒŒåŒ…æœ‰ä»€ä¹ˆï¼š...
2. ç©å®¶è¯´äº†ä»€ä¹ˆï¼Œæƒ³åšä»€ä¹ˆ...
3. ç‰©å“æ£€æŸ¥...
...
[æ€è€ƒç»“æŸ]

[å›å¤å†…å®¹]
ä½ çš„å®é™…å›å¤å†…å®¹...
`;
```

**ä½œç”¨ï¼š** å¼ºåˆ¶ AI æŒ‰ç…§å›ºå®šæ ¼å¼è¾“å‡ºæ€è€ƒè¿‡ç¨‹å’Œå›å¤å†…å®¹

---

### 2ï¸âƒ£ **AI è¿”å›å“åº”** (NPCChat.tsx ç¬¬ 352-379 è¡Œ)

```typescript
const response = await fetch(API_URL, {
  method: "POST",
  body: JSON.stringify({
    model: "qwen-plus",
    messages: [
      { role: "system", content: enhancedSystemPrompt },
      ...conversationMessages,
    ],
  }),
});

const data = await response.json();
let npcResponse = data.choices[0].message.content;
```

**AI è¿”å›çš„åŸå§‹å†…å®¹ç¤ºä¾‹ï¼š**
```
[æ€è€ƒå¼€å§‹]
ç©å®¶èƒŒåŒ…æœ‰ä»€ä¹ˆï¼šåŒ…å­ã€æ°´å£¶ã€å¤ä¹¦
ç©å®¶è¯´äº†ä»€ä¹ˆï¼šç©å®¶è¯´æƒ³åƒåŒ…å­
ç‰©å“æ£€æŸ¥ï¼šèƒŒåŒ…é‡Œæœ‰"åŒ…å­"ï¼Œå¯ä»¥åƒ
æˆ‘è¯¥å¦‚ä½•å›åº”ï¼šåŒæ„ç©å®¶åƒåŒ…å­ï¼Œæè¿°æ•ˆæœ
å…³ç³»ä¼šå¦‚ä½•å˜åŒ–ï¼šå¥½æ„Ÿåº¦+2
[æ€è€ƒç»“æŸ]

[å›å¤å†…å®¹]
ä½ åƒæ‰äº†çƒ­ä¹ä¹çš„åŒ…å­ï¼Œæ„Ÿè§‰æš–å’Œå¤šäº†ã€‚[ä½¿ç”¨ï¼šåŒ…å­]
```

---

### 3ï¸âƒ£ **è§£ææ€è€ƒå†…å®¹** (NPCChat.tsx ç¬¬ 361-393 è¡Œ)

```typescript
// ä½¿ç”¨æ­£åˆ™åŒ¹é…æå–æ€è€ƒå†…å®¹
const thinkingMatch = npcResponse.match(/\[æ€è€ƒå¼€å§‹\]([\s\S]*?)\[æ€è€ƒç»“æŸ\]/);
let parsedThinkingSteps: string[] = [];

if (thinkingMatch) {
  const thinkingContent = thinkingMatch[1].trim();
  console.log("ğŸ’­ [NPCChat] åŸå§‹æ€è€ƒå†…å®¹:", thinkingContent);
  
  // æå–åˆ°çš„å†…å®¹ï¼š
  // "ç©å®¶èƒŒåŒ…æœ‰ä»€ä¹ˆï¼šåŒ…å­ã€æ°´å£¶ã€å¤ä¹¦\nç©å®¶è¯´äº†ä»€ä¹ˆï¼šç©å®¶è¯´æƒ³åƒåŒ…å­\n..."
```

**æ­£åˆ™è¡¨è¾¾å¼è§£é‡Šï¼š**
- `\[æ€è€ƒå¼€å§‹\]` - åŒ¹é… "[æ€è€ƒå¼€å§‹]" æ ‡è®°
- `([\s\S]*?)` - æ•è·ä»»æ„å­—ç¬¦ï¼ˆåŒ…æ‹¬æ¢è¡Œï¼‰ï¼Œéè´ªå©ªæ¨¡å¼
- `\[æ€è€ƒç»“æŸ\]` - åŒ¹é… "[æ€è€ƒç»“æŸ]" æ ‡è®°

**æå–ç»“æœï¼š**
```
ç©å®¶èƒŒåŒ…æœ‰ä»€ä¹ˆï¼šåŒ…å­ã€æ°´å£¶ã€å¤ä¹¦
ç©å®¶è¯´äº†ä»€ä¹ˆï¼šç©å®¶è¯´æƒ³åƒåŒ…å­
ç‰©å“æ£€æŸ¥ï¼šèƒŒåŒ…é‡Œæœ‰"åŒ…å­"ï¼Œå¯ä»¥åƒ
æˆ‘è¯¥å¦‚ä½•å›åº”ï¼šåŒæ„ç©å®¶åƒåŒ…å­ï¼Œæè¿°æ•ˆæœ
å…³ç³»ä¼šå¦‚ä½•å˜åŒ–ï¼šå¥½æ„Ÿåº¦+2
```

---

### 4ï¸âƒ£ **åˆ†å‰²æˆæ­¥éª¤æ•°ç»„** (NPCChat.tsx ç¬¬ 370-389 è¡Œ)

```typescript
// å…ˆå°è¯•æŒ‰åŒæ¢è¡Œåˆ†æ®µ
let steps = thinkingContent.split(/\n\n+/).filter(s => s.trim());

// å¦‚æœæ²¡æœ‰æ®µè½ï¼ŒæŒ‰å¥å·åˆ†å‰²
if (steps.length <= 1) {
  steps = thinkingContent.split(/[ã€‚ï¼›]/).filter(s => s.trim());
}

// å¦‚æœè¿˜æ˜¯åªæœ‰ä¸€æ®µï¼Œå°±ä¿æŒåŸæ ·
if (steps.length === 0) {
  steps = [thinkingContent];
}

parsedThinkingSteps = steps.map(s => s.trim());
```

**åˆ†å‰²ç­–ç•¥ï¼š**
1. **ä¼˜å…ˆæŒ‰æ®µè½**ï¼ˆåŒæ¢è¡Œ `\n\n`ï¼‰åˆ†å‰²
2. **å…¶æ¬¡æŒ‰å¥å­**ï¼ˆå¥å·ã€åˆ†å· `ã€‚ï¼›`ï¼‰åˆ†å‰²
3. **ä¿æŒåŸæ ·**ï¼ˆå¦‚æœéƒ½ä¸é€‚ç”¨ï¼‰

**åˆ†å‰²åçš„ç»“æœï¼š**
```typescript
parsedThinkingSteps = [
  "ç©å®¶èƒŒåŒ…æœ‰ä»€ä¹ˆï¼šåŒ…å­ã€æ°´å£¶ã€å¤ä¹¦",
  "ç©å®¶è¯´äº†ä»€ä¹ˆï¼šç©å®¶è¯´æƒ³åƒåŒ…å­",
  "ç‰©å“æ£€æŸ¥ï¼šèƒŒåŒ…é‡Œæœ‰"åŒ…å­"ï¼Œå¯ä»¥åƒ",
  "æˆ‘è¯¥å¦‚ä½•å›åº”ï¼šåŒæ„ç©å®¶åƒåŒ…å­ï¼Œæè¿°æ•ˆæœ",
  "å…³ç³»ä¼šå¦‚ä½•å˜åŒ–ï¼šå¥½æ„Ÿåº¦+2"
]
```

---

### 5ï¸âƒ£ **ä¿å­˜åˆ°æ¶ˆæ¯å¯¹è±¡** (NPCChat.tsx ç¬¬ 562-568 è¡Œ)

```typescript
const assistantMessage: Message = {
  role: "assistant",
  content: npcResponse,  // æ¸…ç†åçš„å›å¤å†…å®¹ï¼ˆä¸åŒ…å«æ€è€ƒï¼‰
  timestamp: Date.now(),
  id: generateMessageId(),
  thinkingSteps: parsedThinkingSteps.length > 0 ? parsedThinkingSteps : undefined,
};

// ç­‰å¾…åŠ¨ç”»åæ·»åŠ åˆ°æ¶ˆæ¯åˆ—è¡¨
await new Promise(resolve => setTimeout(resolve, 1500));
setMessages((prev) => [...prev, assistantMessage]);
```

**Message å¯¹è±¡ç»“æ„ï¼š**
```typescript
{
  role: "assistant",
  content: "ä½ åƒæ‰äº†çƒ­ä¹ä¹çš„åŒ…å­ï¼Œæ„Ÿè§‰æš–å’Œå¤šäº†ã€‚",
  timestamp: 1700000000000,
  id: "msg-1700000000000-5",
  thinkingSteps: [
    "ç©å®¶èƒŒåŒ…æœ‰ä»€ä¹ˆï¼šåŒ…å­ã€æ°´å£¶ã€å¤ä¹¦",
    "ç©å®¶è¯´äº†ä»€ä¹ˆï¼šç©å®¶è¯´æƒ³åƒåŒ…å­",
    "ç‰©å“æ£€æŸ¥ï¼šèƒŒåŒ…é‡Œæœ‰"åŒ…å­"ï¼Œå¯ä»¥åƒ",
    "æˆ‘è¯¥å¦‚ä½•å›åº”ï¼šåŒæ„ç©å®¶åƒåŒ…å­ï¼Œæè¿°æ•ˆæœ",
    "å…³ç³»ä¼šå¦‚ä½•å˜åŒ–ï¼šå¥½æ„Ÿåº¦+2"
  ]
}
```

---

### 6ï¸âƒ£ **æ¸²æŸ“æ˜¾ç¤º** (NPCChat.tsx ç¬¬ 857-873 è¡Œ)

```typescript
{messages.map((message) => (
  <div key={message.id}>
    {/* å¦‚æœè¿™æ¡æ¶ˆæ¯æœ‰æ€è€ƒæ­¥éª¤ï¼Œå…ˆæ˜¾ç¤ºæ€è€ƒæ¡† */}
    {message.thinkingSteps && message.thinkingSteps.length > 0 && (
      <div className="mb-2">
        <ThinkingMessage
          isThinking={false}
          thinkingSteps={message.thinkingSteps}
        />
      </div>
    )}
    
    {/* æ˜¾ç¤ºæ¶ˆæ¯å†…å®¹ */}
    <div className="...">
      {message.content}
    </div>
  </div>
))}
```

**æ¸²æŸ“é€»è¾‘ï¼š**
1. éå† `messages` æ•°ç»„
2. æ£€æŸ¥æ¯æ¡æ¶ˆæ¯çš„ `thinkingSteps` å±æ€§
3. å¦‚æœæœ‰æ€è€ƒæ­¥éª¤ï¼Œå…ˆæ¸²æŸ“ `<ThinkingMessage>` ç»„ä»¶
4. ç„¶åæ¸²æŸ“æ¶ˆæ¯å†…å®¹

---

### 7ï¸âƒ£ **ThinkingMessage ç»„ä»¶æ˜¾ç¤º** (ThinkingMessage.tsx)

```typescript
export function ThinkingMessage({ 
  isThinking = false, 
  thinkingSteps = [] 
}: ThinkingMessageProps) {
  const [isExpanded, setIsExpanded] = useState(false);
  
  useEffect(() => {
    if (isThinking) {
      // æ­£åœ¨æ€è€ƒä¸­ï¼šä¿æŒæŠ˜å ï¼Œä¸å±•å¼€
      setIsExpanded(false);
    } else {
      // æ€è€ƒå®Œæˆï¼šé»˜è®¤æŠ˜å ï¼Œå¯ç‚¹å‡»å±•å¼€
      setIsExpanded(false);
    }
  }, [isThinking]);
  
  return (
    <div>
      {/* æ ‡é¢˜æ  */}
      <button onClick={() => setIsExpanded(!isExpanded)}>
        {isThinking ? "âœ¨ æ€è€ƒä¸­..." : `âœ¨ æ€è€ƒå®Œæˆ (${thinkingSteps.length} ä¸ªæ­¥éª¤)`}
      </button>
      
      {/* å±•å¼€çš„æ€è€ƒæ­¥éª¤ */}
      {isExpanded && !isThinking && (
        <div>
          {thinkingSteps.map((step, index) => (
            <div key={index}>â— {step}</div>
          ))}
        </div>
      )}
    </div>
  );
}
```

**æ˜¾ç¤ºæ•ˆæœï¼š**

**æŠ˜å çŠ¶æ€ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ¨ æ€è€ƒå®Œæˆ (5 ä¸ªæ­¥éª¤)    â–¶         â”‚  â† å¯ç‚¹å‡»
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å±•å¼€çŠ¶æ€ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ¨ æ€è€ƒå®Œæˆ            â–¼            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â— ç©å®¶èƒŒåŒ…æœ‰ä»€ä¹ˆï¼šåŒ…å­ã€æ°´å£¶ã€å¤ä¹¦  â”‚
â”‚ â— ç©å®¶è¯´äº†ä»€ä¹ˆï¼šç©å®¶è¯´æƒ³åƒåŒ…å­      â”‚
â”‚ â— ç‰©å“æ£€æŸ¥ï¼šèƒŒåŒ…é‡Œæœ‰"åŒ…å­"ï¼Œå¯ä»¥åƒ  â”‚
â”‚ â— æˆ‘è¯¥å¦‚ä½•å›åº”ï¼šåŒæ„ç©å®¶åƒåŒ…å­...   â”‚
â”‚ â— å…³ç³»ä¼šå¦‚ä½•å˜åŒ–ï¼šå¥½æ„Ÿåº¦+2          â”‚
â”‚ âœ“ æ€è€ƒå®Œæˆ                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ å®Œæ•´æ—¶åºå›¾

```
ç”¨æˆ·å‘é€æ¶ˆæ¯ "æˆ‘åƒä¸ªåŒ…å­"
    â†“
[1] æ„å»ºå¢å¼ºç³»ç»Ÿæç¤ºè¯ (enhancedSystemPrompt)
    â”œâ”€ åŒ…å«ï¼š[æ€è€ƒå¼€å§‹]...[æ€è€ƒç»“æŸ] æ ¼å¼è¦æ±‚
    â”œâ”€ åŒ…å«ï¼šç©å®¶èƒŒåŒ…åˆ—è¡¨
    â””â”€ åŒ…å«ï¼šå…³ç³»å€¼ã€å¥½æ„Ÿåº¦ç­‰ä¿¡æ¯
    â†“
[2] è°ƒç”¨ AI API (é€šä¹‰åƒé—® qwen-plus)
    â†“
[3] AI è¿”ï¿½ï¿½ï¿½å“åº”
    â””â”€ "[æ€è€ƒå¼€å§‹]\nç©å®¶èƒŒåŒ…æœ‰ä»€ä¹ˆï¼šåŒ…å­...\n[æ€è€ƒç»“æŸ]\n[å›å¤å†…å®¹]\nä½ åƒæ‰äº†..."
    â†“
[4] æ­£åˆ™åŒ¹é…æå–æ€è€ƒå†…å®¹
    â””â”€ thinkingMatch[1] = "ç©å®¶èƒŒåŒ…æœ‰ä»€ä¹ˆï¼šåŒ…å­...\n..."
    â†“
[5] åˆ†å‰²æˆæ­¥éª¤æ•°ç»„
    â””â”€ ["ç©å®¶èƒŒåŒ…æœ‰ä»€ä¹ˆï¼šåŒ…å­", "ç©å®¶è¯´äº†ä»€ä¹ˆï¼š...", ...]
    â†“
[6] åˆ›å»ºæ¶ˆæ¯å¯¹è±¡
    â””â”€ assistantMessage.thinkingSteps = [...]
    â†“
[7] ç­‰å¾… 1.5 ç§’ï¼ˆæ€è€ƒåŠ¨ç”»ï¼‰
    â†“
[8] æ·»åŠ åˆ° messages æ•°ç»„
    â””â”€ setMessages(prev => [...prev, assistantMessage])
    â†“
[9] React æ¸²æŸ“
    â”œâ”€ æ£€æµ‹åˆ° message.thinkingSteps å­˜åœ¨
    â”œâ”€ æ¸²æŸ“ <ThinkingMessage thinkingSteps={...} />
    â””â”€ æ¸²æŸ“æ¶ˆæ¯å†…å®¹
    â†“
[10] ç”¨æˆ·ç‚¹å‡» "æ€è€ƒå®Œæˆ" å±•å¼€æŸ¥çœ‹
    â””â”€ æ˜¾ç¤ºæ‰€æœ‰æ€è€ƒæ­¥éª¤
```

---

## ğŸ“Š æ•°æ®æµå‘æ€»ç»“

| æ­¥éª¤ | ä½ç½® | æ•°æ®å½¢å¼ | ç¤ºä¾‹ |
|------|------|----------|------|
| **1. ç³»ç»Ÿæç¤º** | enhancedSystemPrompt | å­—ç¬¦ä¸²æ¨¡æ¿ | `"=== é‡è¦ï¼šæ€è€ƒè¿‡ç¨‹è¾“å‡ºæ ¼å¼ ===\n[æ€è€ƒå¼€å§‹]..."` |
| **2. AI è¿”å›** | npcResponse | å®Œæ•´å­—ç¬¦ä¸² | `"[æ€è€ƒå¼€å§‹]\nç©å®¶èƒŒåŒ…...\n[æ€è€ƒç»“æŸ]\n[å›å¤å†…å®¹]\nä½ åƒæ‰..."` |
| **3. æ­£åˆ™æå–** | thinkingContent | çº¯æ€è€ƒå­—ç¬¦ä¸² | `"ç©å®¶èƒŒåŒ…æœ‰ä»€ä¹ˆï¼šåŒ…å­\nç©å®¶è¯´äº†ä»€ä¹ˆï¼š..."` |
| **4. åˆ†å‰²æ•°ç»„** | parsedThinkingSteps | å­—ç¬¦ä¸²æ•°ç»„ | `["ç©å®¶èƒŒåŒ…æœ‰ä»€ä¹ˆï¼šåŒ…å­", "ç©å®¶è¯´äº†ä»€ä¹ˆï¼š..."]` |
| **5. ä¿å­˜å¯¹è±¡** | assistantMessage.thinkingSteps | å­—ç¬¦ä¸²æ•°ç»„ | `["...", "...", "..."]` |
| **6. ä¼ é€’ç»„ä»¶** | ThinkingMessage props | å­—ç¬¦ä¸²æ•°ç»„ | `thinkingSteps={["...", "..."]}` |
| **7. ç”¨æˆ·æŸ¥çœ‹** | å±•å¼€çš„ UI | åˆ—è¡¨æ˜¾ç¤º | `â— ç©å®¶èƒŒåŒ…æœ‰ä»€ä¹ˆï¼šåŒ…å­` |

---

## âœ… å…³é”®è¦ç‚¹

1. **AI å¿…é¡»è¾“å‡º** `[æ€è€ƒå¼€å§‹]` å’Œ `[æ€è€ƒç»“æŸ]` æ ‡è®°
2. **æ­£åˆ™åŒ¹é…** æå–æ€è€ƒå†…å®¹ï¼ˆç¬¬ 361 è¡Œï¼‰
3. **æ™ºèƒ½åˆ†å‰²** æŒ‰æ®µè½æˆ–å¥å­åˆ†å‰²æˆæ•°ç»„ï¼ˆç¬¬ 370-386 è¡Œï¼‰
4. **å­˜å…¥æ¶ˆæ¯** ä¿å­˜åˆ° `assistantMessage.thinkingSteps`ï¼ˆç¬¬ 567 è¡Œï¼‰
5. **æ¡ä»¶æ¸²æŸ“** åªæœ‰ `thinkingSteps.length > 0` æ‰æ˜¾ç¤ºï¼ˆç¬¬ 866 è¡Œï¼‰
6. **ç»„ä»¶æ¥æ”¶** ThinkingMessage æ¥æ”¶æ•°ç»„å¹¶å±•ç¤ºï¼ˆç¬¬ 870 è¡Œï¼‰

---

## ğŸ› å¯èƒ½çš„é—®é¢˜

### é—®é¢˜ 1ï¼šæ€è€ƒå†…å®¹ä¸ºç©º
```typescript
// åŸå› ï¼šAI æ²¡æœ‰æŒ‰ç…§æ ¼å¼è¿”å›
// è§£å†³ï¼šå¼ºåŒ–ç³»ç»Ÿæç¤ºè¯ï¼Œå¼ºåˆ¶è¾“å‡ºæ ‡è®°
```

### é—®é¢˜ 2ï¼šæ€è€ƒæ­¥éª¤ä¸æ˜¾ç¤º
```typescript
// åŸå› ï¼šparsedThinkingSteps ä¸ºç©ºæ•°ç»„
// è°ƒè¯•ï¼šæŸ¥çœ‹ console.log("ğŸ’­ åŸå§‹æ€è€ƒå†…å®¹:", thinkingContent)
```

### é—®é¢˜ 3ï¼šåŠ è½½ä¸­æ˜¾ç¤ºæ­¥éª¤
```typescript
// åŸå› ï¼šisLoading æ—¶ä¼ å…¥äº† thinkingSteps
// è§£å†³ï¼šåŠ è½½ä¸­ä¸ä¼  thinkingSteps propï¼ˆå·²ä¿®å¤ï¼‰
```

---

## ğŸ¯ æ€»ç»“

**æ€è€ƒå®Œæˆé‡Œçš„æ¶ˆæ¯æ¥æºï¼š**
1. ğŸ“ AI æŒ‰ç…§ç³»ç»Ÿæç¤ºè¯è¾“å‡º `[æ€è€ƒå¼€å§‹]...[æ€è€ƒç»“æŸ]`
2. ğŸ” æ­£åˆ™è¡¨è¾¾å¼æå–æ€è€ƒå†…å®¹
3. âœ‚ï¸ åˆ†å‰²æˆå¤šä¸ªæ­¥éª¤ï¼ˆå­—ç¬¦ä¸²æ•°ç»„ï¼‰
4. ğŸ’¾ ä¿å­˜åˆ°æ¶ˆæ¯å¯¹è±¡çš„ `thinkingSteps` å±æ€§
5. ğŸ¨ ThinkingMessage ç»„ä»¶æ¥æ”¶å¹¶æ¸²æŸ“
6. ğŸ‘ï¸ ç”¨æˆ·ç‚¹å‡»å±•å¼€æŸ¥çœ‹è¯¦ç»†æ€è€ƒè¿‡ç¨‹

æ ¸å¿ƒä»£ç ä½ç½®ï¼š`NPCChat.tsx` ç¬¬ 361-393 è¡Œï¼ˆè§£æï¼‰+ ç¬¬ 866-872 è¡Œï¼ˆæ¸²æŸ“ï¼‰
